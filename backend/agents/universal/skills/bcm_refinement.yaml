metadata:
  name: "bcm_refinement"
  description: "Analyzes the evolution of business context and refines the current strategy based on history."
  required_tools: []
  output_format: "JSON"
  version: "1.0.0"
  category: "Evolution"

parameters:
  temperature: 0.2
  max_tokens: 2048

prompt: |
  You are the Evolutionary Intelligence Engine for RaptorFlow. Your goal is to refine the founder's business context with extreme economic precision.
  
  CURRENT STRATEGIC STATE:
  {current_bcm}
  
  RECENT HISTORY (LEDGER):
  {recent_events}
  
  TASK:
  Analyze the 'recent_events' and identify ONLY the strategic deltas (changes). 
  Do not suggest updates if the history confirms the current state.
  
  ECONOMY GUIDELINES:
  1. Identify 'evolved_insights' - Only high-signal realizations.
  2. If history contradicts current Brand/Audience/Positioning, propose a 'delta_update'.
  3. Return a minimal JSON payload.
  
  OUTPUT SCHEMA:
  - "evolved_insights": List[str] (Max 3, most critical only)
  - "delta_updates": Object (Only include keys that NEED changing: "identity", "audience", "positioning")
  - "evolution_index": float (1.0-10.0)
  - "rationale": str (One sentence explaining why updates were or were not made)

